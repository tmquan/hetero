////////////////////////////////////////////////////////////////////////////////////////////////////
// file:	C:\Users\Quan\Dropbox\ECE715 Advanced Computer Graphics\project\poisson\timer.h
//
// summary:	Declares the timer class
////////////////////////////////////////////////////////////////////////////////////////////////////

#ifndef GPU_TIMER_HPP

////////////////////////////////////////////////////////////////////////////////////////////////////
/// <summary>	A macro that defines GPU timer h. </summary>
///
/// <remarks>	Quan, 2/6/2013. </remarks>
////////////////////////////////////////////////////////////////////////////////////////////////////

#define GPU_TIMER_HPP

#include <cuda_runtime.h>

struct GpuTimer
{
	/// <summary>	The start. </summary>
	cudaEvent_t start;
	cudaEvent_t stop;

	////////////////////////////////////////////////////////////////////////////////////////////////////
	/// <summary>	Default constructor. </summary>
	///
	/// <remarks>	Quan, 2/6/2013. </remarks>
	////////////////////////////////////////////////////////////////////////////////////////////////////

	GpuTimer()
	{
		cudaEventCreate(&start);
		cudaEventCreate(&stop);
	}

	~GpuTimer()
	{
		cudaEventDestroy(start);
		cudaEventDestroy(stop);
	}

	////////////////////////////////////////////////////////////////////////////////////////////////////
	/// <summary>	Starts this object. </summary>
	///
	/// <remarks>	Quan, 2/6/2013. </remarks>
	////////////////////////////////////////////////////////////////////////////////////////////////////

	void Start()
	{
		cudaEventRecord(start, 0);
	}

	void Stop()
	{
		cudaEventRecord(stop, 0);
	}

	////////////////////////////////////////////////////////////////////////////////////////////////////
	/// <summary>	Gets the elapsed. </summary>
	///
	/// <remarks>	Quan, 2/6/2013. </remarks>
	///
	/// <returns>	. </returns>
	////////////////////////////////////////////////////////////////////////////////////////////////////

	float Elapsed()
	{
		float elapsed;
		cudaEventSynchronize(stop);
		cudaEventElapsedTime(&elapsed, start, stop);
		return elapsed;
	}
};

#endif 

////////////////////////////////////////////////////////////////////////////////////////////////////
// End of C:\Users\Quan\Dropbox\ECE715 Advanced Computer Graphics\project\poisson\timer.h
////////////////////////////////////////////////////////////////////////////////////////////////////

